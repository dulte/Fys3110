\documentclass[a4paper,norsk, 10pt]{article}
\usepackage[utf8]{inputenc}
\usepackage{verbatim}
\usepackage{listings}
\usepackage{graphicx}
\usepackage[norsk]{babel}
\usepackage{a4wide}
\usepackage{color}
\usepackage{amsmath}
\usepackage{float}
\usepackage{amssymb}
\usepackage[dvips]{epsfig}
\usepackage[toc,page]{appendix}
\usepackage[T1]{fontenc}
\usepackage{cite} % [2,3,4] --> [2--4]
\usepackage{shadow}
\usepackage{hyperref}
\usepackage{titling}
\usepackage{marvosym }
\usepackage{subcaption}
\usepackage[noabbrev]{cleveref}
\usepackage{cite}
\usepackage{physics}


\setlength{\droptitle}{-10em}   % This is your set screw

\setcounter{tocdepth}{2}

\lstset{language=c++}
\lstset{alsolanguage=[90]Fortran}
\lstset{alsolanguage=Python}
\lstset{basicstyle=\small}
\lstset{backgroundcolor=\color{white}}
\lstset{frame=single}
\lstset{stringstyle=\ttfamily}
\lstset{keywordstyle=\color{red}\bfseries}
\lstset{commentstyle=\itshape\color{blue}}
\lstset{showspaces=false}
\lstset{showstringspaces=false}
\lstset{showtabs=false}
\lstset{breaklines}
\title{Fys3110 Hjemmeeksamen}
\author{Kadnr.: }
\begin{document}
\maketitle

\section{Exercise 1:}

\subsection{1.1)}\label{sec:11}
We have a qubit consisting of the two spin-1/2 basis states

\begin{equation}
\ket{0} \equiv \ket{\downarrow} \simeq 
\begin{pmatrix}
0 \\ 1
\end{pmatrix}
\end{equation}
\begin{equation}
\ket{1} \equiv \ket{\uparrow} \simeq 
\begin{pmatrix}
1 \\ 0
\end{pmatrix}
\end{equation}

we then introduce the operator $\hat{\sigma}_x$ represented by the Pauli-matrix

\begin{equation}
\hat{\sigma}_x \simeq
\begin{pmatrix}
0 & 1\\
1 & 0
\end{pmatrix}
\end{equation}

We can then look at how the operator acts on the basis states:

\begin{equation}
\hat{\sigma}_x\ket{0} = 
\begin{pmatrix}
0 & 1\\
1 & 0
\end{pmatrix}
\begin{pmatrix}
0 \\ 1
\end{pmatrix} = 
\begin{pmatrix}
1 \\ 0
\end{pmatrix} = \ket{1}
\end{equation}

\begin{equation}
\hat{\sigma}_x\ket{1} = 
\begin{pmatrix}
0 & 1\\
1 & 0
\end{pmatrix}
\begin{pmatrix}
1 \\ 0
\end{pmatrix} = 
\begin{pmatrix}
0 \\ 1
\end{pmatrix} = \ket{0}
\end{equation}

So the operator $\hat{\sigma}_x$ inverts the states:

\begin{equation}
\hat{\sigma}_x\ket{0} = \ket{1}, \qquad \hat{\sigma}_x\ket{1} = \ket{0}
\end{equation}

\subsection{1.2)}\label{sec:12}

We have two states $\ket{i}$ and $\ket{o}$, and the operator $G$ which acts on the states as follows:

\begin{equation}
\ket{o} = G\ket{i}, \qquad \ket{i} = G\ket{o}
\end{equation}

We can see that 

\begin{equation}
G(G\ket{o}) = G\ket{i} = \ket{o}
\end{equation}

Thus we see that $GG = I \Rightarrow G = G^{-1}$. We can check if $G$ is hermitian looking at the definition of the hermitian conjugate for some operator $K$:

\begin{equation}
\bra{\psi}K\ket{\phi} = \bra{\phi}K^\dagger\ket{\psi}^*
\end{equation}

And if $K$ is hermitian then $K = K^\dagger$ and
\begin{equation}
\bra{\psi}K\ket{\phi} = \bra{\phi}K\ket{\psi}^*
\end{equation}\label{eq:hermitDef}

We can check if this holds for $G$. For this we calculate

\begin{equation}
\bra{o}G\ket{i} = \braket{o}{o}
\end{equation}
\begin{equation}
\bra{i}G\ket{o}^* = \braket{i}{i}^* 
\end{equation}

But these qubits are normalized, so $\braket{i}{i}^*=  \braket{i}{i}=  \braket{o}{o} = 1$, and we there for get

\begin{equation}
\bra{o}G\ket{i} = 1 = \bra{i}G\ket{o}^*
\end{equation}

And thus we have used \eqref{eq:hermitDef} to show that $G$ is hermitian, $G = G^\dagger$. We have also shown that $G = G^{-1}$, but because $G$ under multiplication is a operator group, we are ensured that the identity is unique, and we an therefore conclude that $G^{-1} = G^\dagger$, which means that $G$ is unitary and hermitian.

\subsection{1.3)}

We want to find the NOT gate that switches the two states. But the operator $G$ from sec. \ref{sec:12} does exactly that: it switches $\ket{0}$ to $\ket{i}$ and vice versa. Also, we showed in sec. \ref{sec:11} that the operator $\hat{\sigma}_x$ represented as the Pauli-matrix, took a spin up to down, and down to up. We therefore know that $G$ is the operator for the NOT gate, represented by a Pauli-Matrix:

\begin{equation}
G = \hat{\sigma}_x =
\begin{pmatrix}
0 & 1\\
1 & 0
\end{pmatrix}
\end{equation}

And as shown in sec. \ref{sec:12}, this operator, $G$, is unitary hermitian.

\subsection{1.4)}
For the Hadamard gate (H-gate) we have the following operation:

\begin{equation}
H = \frac{1}{\sqrt{2}}
\begin{pmatrix}
1 & 1 \\
1 & -1
\end{pmatrix}
\end{equation}\label{eq:H}

We can look at its properties. First we find the hermitian transform of $H$:

\begin{equation}
H^\dagger = (H^T)^* = 
\frac{1}{\sqrt{2}}
\begin{pmatrix}
1 & 1 \\
1 & -1
\end{pmatrix}
= H
\end{equation}

Thus showing that $H$ is hermitian. If we multiply $H$ with it self we get

\begin{equation}
H^2 = \frac{1}{2}
\begin{pmatrix}
1 & 1 \\
1 & -1
\end{pmatrix}
\begin{pmatrix}
1 & 1 \\
1 & -1
\end{pmatrix}
=\frac{1}{2}
\begin{pmatrix}
2 & 0 \\
0 & 2
\end{pmatrix}
=
\begin{pmatrix}
1 & 0 \\
0 & 1
\end{pmatrix}
\end{equation}

This means that $H^2 = I \Rightarrow H = H^{-1}$ and that $H$ is unitary.

We can now see what $H$ does to qubit basis states

\begin{equation}
H\ket{0} = 
\frac{1}{\sqrt{2}}
\begin{pmatrix}
1 & 1 \\
1 & -1
\end{pmatrix}
\begin{pmatrix}
0 \\1
\end{pmatrix}
= \frac{1}{\sqrt{2}}
\begin{pmatrix}
1 \\ -1
\end{pmatrix}
\end{equation}
\begin{equation}
H\ket{1} = 
\frac{1}{\sqrt{2}}
\begin{pmatrix}
1 & 1 \\
1 & -1
\end{pmatrix}
\begin{pmatrix}
1 \\ 0
\end{pmatrix}
= \frac{1}{\sqrt{2}}
\begin{pmatrix}
1 \\ 1
\end{pmatrix}
\end{equation}


We can recognize these as the eigenstates for spin in x-direction, so

\begin{equation}
H\ket{0} = \ket{\downarrow_x}
\end{equation}\label{eq:toXdown}

\begin{equation}
H\ket{1} = \ket{\uparrow_x}
\end{equation}\label{eq:toXup}


\subsection{1.5)}
We want to find a magnetic field that that results in the effect of $H$ found is eq. \eqref{eq:toXdown} and \eqref{eq:toXup}. We look at $H$ and see that

\begin{equation}
H = \frac{1}{\sqrt{2}}\left(\sigma_x + \sigma_z\right)
\end{equation}

So we make an educated guess that the magnetic field has to we in $\hat{i} + \hat{k}$ direction. So our Hamiltonian for the magnetic field will be:

\begin{equation}
\hat{H} = -\mathbf{\mu}\cdot \mathbf{B} = - g\frac{\mu_B}{\hbar}\left(\frac{h}{\sqrt{2}}\frac{\hbar}{2}\sigma_x + \frac{h}{\sqrt{2}}\frac{\hbar}{2}\sigma_z\right) = -g\frac{h\mu_B}{2\sqrt{2}}
\begin{pmatrix}
1 & 1 \\
1 & -1
\end{pmatrix}
\end{equation}

With

\begin{equation}
\mathbf{B} = \frac{h}{\sqrt{2}}
\begin{pmatrix}
1 \\ 0 \\ 1
\end{pmatrix}
\end{equation}

The $\sqrt{2}$ being there to ensure that the magnitude of $h$. 

We now what to find the eigenstates of the Hamiltonian so we can express the time evolution of $\ket{0}$ and $\ket{1}$:

\begin{equation}
\begin{pmatrix}
1 & 1 \\
1 & -1
\end{pmatrix}
\qquad
\rightarrow
\qquad
\ket{h_1} = 
\begin{pmatrix}
1 + \sqrt{2} \\ 1
\end{pmatrix},
\ket{h_2} = 
\begin{pmatrix}
1 - \sqrt{2} \\ 1
\end{pmatrix}
\end{equation}

with eigenvalues

\begin{equation}
h_1 = \sqrt{2},\qquad h_2  = -\sqrt{2}
\end{equation}

This gives us the energies for the Hamiltonian

\begin{equation}
E_1 = -g\frac{h\mu_B}{2}, \qquad E_2 = g\frac{h\mu_B}{2}
\end{equation}

We can now express our qubit states as linear combinations of the eigenvalues of the Hamiltonian:

\begin{equation}
\ket{1} = a\ket{h_1} + b\ket{h_2}, \qquad \ket{0} = c\ket{h_1} + d\ket{h_2}
\end{equation}

This turns out to be

\begin{equation}
\ket{1} = \frac{\sqrt{2}}{4}
\begin{pmatrix}
1 + \sqrt{2} \\ 1
\end{pmatrix}
-\frac{\sqrt{2}}{4}
\begin{pmatrix}
1 - \sqrt{2} \\ 1
\end{pmatrix}
\end{equation}
\begin{equation}
\ket{0} = \frac{2-\sqrt{2}}{4}
\begin{pmatrix}
1 + \sqrt{2} \\ 1
\end{pmatrix}
+\frac{2+\sqrt{2}}{4}
\begin{pmatrix}
1 - \sqrt{2} \\ 1
\end{pmatrix}
\end{equation}

\section{Exercise 2:}

\subsection{2.1)}\label{sec:21}


\subsection{2.2)}

We have the operators which works like

\begin{equation}
F\ket{i} = 
\begin{cases}
-\ket{i^*} & , i = i^* \\
\ket{i} & , i \neq i^*
\end{cases}
\end{equation}\label{eq:Feffect}

We want to show that $F$ can be written as

\begin{equation}
F = I - 2\ket{i^*}\bra{i^*}
\end{equation}\label{eq:Foperator}

Let's use the operator on a ket

\begin{equation}
F\ket{i} = (I - 2\ket{i^*}\bra{i^*})\ket{i} = I\ket{i} - 2\ket{i^*}\bra{i^*}\ket{i}
\end{equation}

\begin{equation}
= \ket{i} - 2\delta_{i,i^*}\ket{i^*} =
\begin{cases}
-\ket{i^*} & , i = i^* \\
\ket{i} & , i \neq i^*
\end{cases}
\end{equation}

We can see that this gives the same as \eqref{eq:Feffect}, and we can therefore write $F = I - 2\ket{i^*}\bra{i^*}$.

We can see from eq. \ref{eq:Foperator} that $F$ is a Householder transformation, which ensures that $F$ is unitary hermitian, but we can also show this:

\begin{equation}
F(F\ket{i}) = (I - 2\ket{i^*}\bra{i^*})(I - 2\ket{i^*}\bra{i^*})\ket{i}
\end{equation}
\begin{equation}
= I\ket{i} - 2\ket{i^*}\bra{i^*}I\ket{i} -2I\ket{i^*}\bra{i^*}\ket{i} + 4\ket{i^*}\bra{i^*}\ket{i^*}\bra{i^*}\ket{i}
\end{equation}
\begin{equation}
= \ket{i} - 4\ket{i^*}\bra{i^*}\ket{i} + 4\ket{i^*}\bra{i^*}\ket{i} = \ket{i}
\end{equation}

Thus $FF = I \Rightarrow F = F^{-1}$. We then show that $F$ is hermitian:

\begin{equation}
F^\dagger = (I - 2\ket{i^*}\bra{i^*})^\dagger = I - 2(\ket{i^*}\bra{i^*})^\dagger
\end{equation}
\begin{equation}
= I - 2(\bra{i^*})^\dagger(\ket{i^*})^\dagger = I - 2\ket{i^*}\bra{i^*} = F
\end{equation}

So $F$ is hermitian, $F = F^\dagger$. This implies that $F$ is unitary hermitian:

\begin{equation}
F^{-1} = F = F^\dagger \Leftrightarrow F^\dagger = F^{-1}
\end{equation}


\subsection{2.3}
We now introduce the superposition of the states $\ket{i}$

\begin{equation}
\ket{s} = \frac{1}{\sqrt{N}} \sum_{i=1}^N \ket{i}
\end{equation}

We then calculate 

\begin{equation}
\braket{i^*}{s} = \frac{1}{\sqrt{N}} \sum_{i=1}^N \braket{i^*}{i} = \frac{1}{\sqrt{N}} \sum_{i=1}^N \delta_{i,i^*} = \frac{1}{\sqrt{N}} 
\end{equation}\label{eq:is}


and

\begin{equation}
F\ket{s} = I\ket{s} - 2\ket{i^*}\bra{i^*}\ket{s} = \ket{s} - \frac{2}{\sqrt{N}}\ket{i^*}
\end{equation}\label{eq:Fs}



\subsection{2.4)}

We now consider the state:

\begin{equation}
\ket{g} = \alpha \ket{s} + \beta\ket{i^*}
\end{equation}

We want this to be normalized:

\begin{equation}
\braket{g}{g} = 1
\end{equation}

Due to Riesz representation theorem, we know that such a bra $\bra{g}$ exist, so we can then find the condition for $\alpha$ and $\beta$ such that $\ket{g}$ is normalized.

\begin{equation}
(\alpha* \bra{s} + \beta*\bra{i^*})(\alpha \ket{s} + \beta\ket{i^*}) = |\alpha|^2 + |\beta|^2 + \alpha\beta* \braket{s}{i^*} + \alpha*\beta \braket{i^*}{s}
\end{equation}

$\alpha$ and $\beta$ are both real. We know that $\braket{i^*}{s}$ is real from \eqref{eq:is}, so $\braket{s}{i^*} = \braket{i^*}{s}* = \braket{i^*}{s}$. So: 

\begin{equation}
\alpha^2 + \beta^2 + \frac{2\alpha \beta}{\sqrt{N}} = 1
\end{equation}\label{eq:conditionAB}

Is the condition that makes sure that $\ket{g}$ is normalized.

\subsection{2.5)}

The operator for measuring the measurement $i$ of state $\ket{i}$ is named $X$, so $X$ acting on a state $\ket{i}$ is:

\begin{equation}
X\ket{i} = i\ket{i}
\end{equation}

meaning that $\ket{i}$ are eigenstates of $X$ with eigenvalue $i$. This means that we can use the spectral theorem to write $X$ as a spectral representation with $\ket{i}$ and $i$:

\begin{equation}
X = \sum_{j=1}^N j\ket{j}\bra{j}
\end{equation}

($j$ and $i$ are dummy indices and therefore interchanged).

\subsection{2.6)}

We want to find the probability of measuring $i^*$ when observing $\ket{g}$. From $X$ we find

\begin{equation}
X\ket{i^*} = i^*\ket{i^*} 
\end{equation}

Meaning that $\ket{i^*}$ is the state where we measure $i^*$, meaning that we need to find the probability of measuring $\ket{g}$ in state $\ket{i^*}$. We d this with the projection operator

\begin{equation}
\hat{P} = \ketbra{i^*}{i^*}
\end{equation}

We then find the expectation value of $P$ acting on $\ket{g}$:

\begin{equation}
P(i^*) = \bra{g}\hat{P}\ket{g} = \bra{g}\ket{i^*}\bra{i^*}\ket{g} = |\braket{i^*}{g}|^2
\end{equation}

We can calculate this

\begin{equation}
\braket{i^*}{g} = \bra{i^*}(\alpha \ket{s} + \beta\ket{i^*}) = \alpha\braket{i^*}{s}+ \beta \braket{i^*}{i^*} = \frac{\alpha}{\sqrt{N}} + \beta
\end{equation}

All the terms are real, so the norm in the probability just becomes a power of two:

\begin{equation}
\Rightarrow P(i^*) = |\braket{i^*}{g}|^2 = \left(\frac{\alpha}{\sqrt{N}} + \beta\right)^2 = \frac{\alpha^2}{N} + \beta^2 + \frac{\alpha\beta}{\sqrt{N}}
\end{equation}

From eq. \eqref{eq:conditionAB} we see that

\begin{equation}
\beta^2 + \frac{2\alpha \beta}{\sqrt{N}}  = 1 - \alpha^2
\end{equation}

So we get that the probability of measuring $i^*$ becomes:

\begin{equation}
P(i^*) = 1 - \alpha^2\left(1 - \frac{1}{N}\right)
\end{equation}\label{eq:prob}

\subsection{2.7)}

We now introduce the operator

\begin{equation}
U = 2\ketbra{s}{s} - I
\end{equation}\label{eq:U}

We want to look at $UF\ket{s}$. We already calculated $F\ket{s}$\eqref{eq:Fs}, so we get: 

\begin{equation}
UF\ket{s} = U(\ket{s} - \frac{2}{\sqrt{N}}\ket{i^*})
\end{equation}
\begin{equation}
= 2\ket{s}\braket{s}{s} - I\ket{s} - \frac{4}{\sqrt{N}}\ket{s}\braket{s}{i^*} + \frac{2}{\sqrt{N}}I\ket{i^*} = \ket{s} - \frac{4}{N}\ket{s} + \frac{2}{\sqrt{N}}\ket{i^*} 
\end{equation}

So

\begin{equation}
UF\ket{s} =  \left(1 - \frac{4}{N}\right)\ket{s} + \frac{2}{\sqrt{N}}\ket{i^*} 
\end{equation}\label{eq:UFs}


If we look at $U$\eqref{eq:U} we see that it too is a Householder transformation(with a negative sign), thus we know that it is unitary hermitian. A unitary always preserves the norm. So if we first apply $F$(which we showed was unitary) to $\ket{s}$, its norm is still $1$ ($\ket{s}$ is a normalized sum of normalized states). So when we then apply $U$, the norm is still $1$. Thus the norm of $UF\ket{s}$ is $1$. But we can also show this explicit:

\begin{equation}
\left[\left(1 - \frac{4}{N}\right)\bra{s} + \frac{2}{\sqrt{N}}\bra{i^*}\right]\left[\left(1 - \frac{4}{N}\right)\ket{s} + \frac{2}{\sqrt{N}}\ket{i^*}\right]
\end{equation}

(remember that all the constants are real)

\begin{equation}
= \left(1 - \frac{4}{N}\right)^2\braket{s}{s} +\frac{2}{\sqrt{N}} \left(1 - \frac{4}{N}\right)\bra{s}\ket{i^*} + \frac{2}{\sqrt{N}} \left(1 - \frac{4}{N}\right)\bra{i^*}\ket{s} + \frac{4}{N}\braket{i^*}{i^*}
\end{equation}

\begin{equation}
= \left(1 - \frac{4}{N}\right)^2 + \frac{4}{N}\left(1 - \frac{4}{N}\right) + \frac{4}{N}
\end{equation}
\begin{equation}
= 1 - \frac{8}{N} + \frac{16}{N^2} + \frac{4}{N} - \frac{16}{N^2} + \frac{4}{N} = 1
\end{equation}


So we have showed that the norm of $UF\ket{s}$ is $1$.


\subsection{2.8)}

We now want to calculate $UF\ket{g}$:

\begin{equation}
UF\ket{g} = UF(\alpha\ket{s} + \beta\ket{i^*}) = \alpha UF\ket{s} + \beta UF\ket{i^*}
\end{equation}

We have already found $UF\ket{s}$\eqref{eq:UFs}, but we need to find

\begin{equation}
UF\ket{i^*} = -U\ket{i^*} = -(2\ketbra{s}{s} - I)\ket{i^*} = -2\ket{s}\braket{s}{i^*} + I\ket{i^*}
\end{equation}
\begin{equation}
= \ket{i^*} - \frac{2}{\sqrt{N}}\ket{s}
\end{equation}


We can now combine these

\begin{equation}
\alpha UF\ket{s} + \beta UF\ket{i^*} = \alpha\left[\left(1 - \frac{4}{N}\right)\ket{s} + \frac{2}{\sqrt{N}}\ket{i^*} \right] + \beta\left[\ket{i^*} - \frac{2}{\sqrt{N}}\ket{s}\right]
\end{equation}

We can so sort these and find 

\begin{equation}
UF(\alpha\ket{s} + \beta\ket{i^*}) = \left[\alpha\left(1 - \frac{4}{N}\right) - \frac{2\beta}{\sqrt{N}}\right]\ket{s} + \left[\frac{2\alpha}{\sqrt{N}} + \beta\right]\ket{i^*}
\end{equation}\label{eq:UFg}

\subsection{2.9)}

We can numerically compute the probability of measuring $i^*$ in the state $(UF)^n\ket{s}$. But as we can see from eq. \eqref{eq:UFs} we get a contribution from $\ket{i^*}$, and it gets the same form as $UF\ket{g}$, thus this is the same as calculating $(UF)^n\ket{g}$ with the initial conditions $\beta = 0$. We know from eq. \ref{eq:UFg} how this system evolve. We can write the coefficients in front of $\ket{s}$ and $\ket{i^*}$ as $\alpha_{new}$ and $\beta_{new}$ and get a simple algorithm for calculating evolution under $UF$\eqref{item:algo}. Each time we update the system we check the probability of measuring $i^*$ we found in \eqref{eq:prob}.

We want to find for what $n$ we get $99\%$ of measuring $i^*$. To do this we simply exit the loop when this probability is reached, saving the $n$ at which this happens.

The final algorithm looks like this:

\begin{itemize}\label{item:algo}
\item Start with $\alpha = 1$, $\beta = 0$
\item loop over n:
\subitem Calculate $\alpha_{new} = \left[\alpha\left(1 - \frac{4}{N}\right) - \frac{2\beta}{\sqrt{N}}\right]$ and $\beta_{new} = \left[\frac{2\alpha}{\sqrt{N}} + \beta\right]$
\subitem Set $\alpha = \alpha_{new}$ and $\beta = \beta_{new}$
\subitem Find the probability $P(i^*) = 1 - \alpha^2\left(1 - \frac{1}{N}\right)$
\subitem If $P(i^*) \geq 0.99$:
\subsubitem Save n
\subsubitem Exit loop
\end{itemize}

The code is found at the end\ref{sec:code}.


If we don't exit the loop after $P \neq 0.99$ but look at how the probability evolves:

\begin{figure}[H]
    \centering
    \begin{subfigure}[b]{0.3\textwidth}
        \includegraphics[width=\textwidth]{P1e3.png}
        \caption{Probability for $N = 10^3$}
        \label{fig:P1e3}
    \end{subfigure}
    ~ %add desired spacing between images, e. g. ~, \quad, \qquad, \hfill etc. 
      %(or a blank line to force the subfigure onto a new line)
    \begin{subfigure}[b]{0.3\textwidth}
        \includegraphics[width=\textwidth]{P1e4.png}
        \caption{Probability for $N = 10^4$}
        \label{fig:P1e4}
    \end{subfigure}
    ~ %add desired spacing between images, e. g. ~, \quad, \qquad, \hfill etc. 
    %(or a blank line to force the subfigure onto a new line)
    \begin{subfigure}[b]{0.3\textwidth}
        \includegraphics[width=\textwidth]{P1e5.png}
        \caption{Probability for $N = 10^5$}
        \label{fig:P1e5}
    \end{subfigure}
    \caption{We can see that the probability of measuring $i^*$ actually goes as a sinusoidal function of $n$. This means that using $UF$ doesn't always imporove the probability, and that there are regoins where applying $UF$ actually lowers the probability. We also see that frequancy of this sinusoidal function increases with the number of unknown states $N$, and thus we need to apply $UF$ more times to get a better probability.}\label{fig:prob}
\end{figure}


We can then look at how many $n = n^*$ is necessary to get a probability $P(i^*)\geq 0.99$:

\begin{figure}[H]
\centering
\includegraphics[scale=0.5]{pi.png}
\caption{The number of times $n^*$ we need to apply $UF$ to get a probability $P(i^*)\geq 0.99$ }
\end{figure}

We can see that as $N$ increases, so does the number if times we need to apply $UF$ this number $n^*$. It looks quite like a square root, but we need to make sure. For this we use a log-log plot, this is because:

\begin{equation}
n^* = N^i \Rightarrow \log(n^*) = i\cdot \log(N)
\end{equation}

So we can use the log-log plot, find the slope and therefore find the order of N of which $n^*$ increases.


\begin{figure}[H]
\centering
\includegraphics[scale=0.5]{logpi.png}
\caption{This shows $\log(n^*)$ vs $\log(n)$ and clearly shows a straight line. The slope of this line is the order of $N$ at which $n^*$ increases.}
\end{figure}


If we use a normal finite difference on this curve(which is exact for a linear function), we find that slope is $\sim 0.503$. This is close enough to $1/2$ that we can conclude that

\begin{equation}
n^* \sim O(\sqrt{N})
\end{equation}

This is an immense improvement over the classical result from sec. \ref{sec:21}, but more on this below.


\section{Code}\label{sec:code}
\lstinputlisting{29.py}


\end{document}


